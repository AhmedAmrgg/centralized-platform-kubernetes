apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: keycloak
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://charts.bitnami.com/bitnami
    targetRevision: 25.2.0
    chart: keycloak
    helm:
      values: |
        image:
          registry: docker.io
          repository: bitnamilegacy/keycloak
          tag: 26.3.3-debian-12-r0
        postgresql:
          image:
            registry: registry-1.docker.io
            repository: bitnamilegacy/postgresql
            tag: 17.6.0-debian-12-r4             
        auth:
          adminUser: "admin"
          adminPassword: "admin1"
          database: keycloakdb
        persistence:
          enabled: true
          size: "1Gi"
      releaseName: keycloak
  destination:
    server: https://kubernetes.default.svc
    namespace: keyclock
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
    - CreateNamespace=true






# replicaCount: 1

# auth:
#   adminUser: "admin"
#   adminPassword: "adminpassword"

# postgresql:
#   enabled: true
#   postgresqlUsername: keycloak
#   postgresqlPassword: keycloakpassword
#   postgresqlDatabase: keycloak
#   persistence:
#     enabled: true
#     size: 8Gi

# persistence:
#   enabled: true
#   size: 8Gi

# service:
#   type: ClusterIP
#   port: 8080

# resources:
#   requests:
#     memory: 512Mi
#     cpu: 250m
#   limits:
#     memory: 1Gi
#     cpu: 500m
# postgresql:
#   enabled: true
#   auth:
#     postgresPassword: ""
#     username: bn_keycloak
#     password: ""
#     database: bitnami_keycloak